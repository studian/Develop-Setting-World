Robopeak RPLIDAR 





소스관리 툴 git 설치 



 $ sudo apt-get install git
 




git clone 명령으로 소스가 복사되어야할 위치로 디렉토리 변경( catkin_make 실행시 대상 소스의 위치는 ~/catkin_ws/src )



 $ cd ~/catkin_ws/src
 

 


git clone으로 rplidar의 ROS 패키지의 소스코드 복사



 $ git clone https://github.com/robopeak/rplidar_ros
 




복사가 잘 됬는지 확인하는 과정이므로 선행 과정( git clone )에서 특별한 에러 메세지가 없었다면 Skip~



 $ ls ~/catkin_ws/src

   CMakeLists.txt  rplidar_ros

 $ ls ~/catkin_ws/src/rplidar_ros

   CHANGELOG.rst   LICENSE    launch       rplidar-frame.png  sdk
   CMakeLists.txt  README.md  package.xml  rviz               srcs
 

​


catkin_make의 실행은 catkin workspace에서 실행해야 한다.



 $ cd ~/catkin_ws
 

​


빌드할 2개의 node( rplidarNode 와 rplidarNodeClient )중 rplidarNode 빌드



 $ catkin_make rplidarNode
 




rplidarNodeClient 빌드


 $ catkin_make rplidarNodeClient
 




아래의 rules를 이용하여 rplidar 장치의 permittion 설정


   KERNEL=="ttyUSB*", MODE="0666"
 




이 과정을 빠트리면, /dev/ttyUSB0 장치를 사용하는 node 구동 시 permittion 에러로 인해 node가 실행되지 않는다. 임시 방편으로 sudo chmod 666 /dev/dev/ttyUSB0 를 실행하면 되지만, 해당 USB 장치를 분리 후 재연결 하거나, 콘솔창을 다시 열거나, 시스템이 리부팅 될 때마다 다시 실행 해주어야 하므로, 아래 처럼 udev.rules를 수정한다. 




'/etc/udev/rules.d/70-persistent-net.rules' 파일을 열어 아래 표시된 부분을 추가한다.


 $ sudo nano /etc/udev/rules.d/70-persistent-net.rules
 






  GNU nano 2.2.6           File: /etc/init.d/ttyAMA0.conf             Modified

​# This file was automatically generated by the /lib/udev/write_net_rules
# program, run by the persistent-net-generator.rules rules file.
#
# You can modify it, as long as you keep each rule on a single
# line, and change only the value of the NAME= key.

# USB device 0x:0x (smsc95xx)
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="b8:27:eb:14:a2:$

# USB device 0x:0x (rtl8192cu)
SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="00:a8:2b:00:04:$ 

# USB device for rplidar

KERNEL=="ttyUSB*", MODE="0666" 



^G Get Help  ^O WriteOut  ^R Read File ^Y Prev Page ^K Cut Text  ^C Cur Pos
^X Exit      ^J Justify   ^W Where Is  ^V Next Page ^U UnCut Text^T To Spell 
 
 

 


udev 는 시스템에 연결된 장치의 노드를 그 연결순서와 상관없이 연결될 때마다 동적으로 제공하는 일종의 장치관리자로서, 장치가 연결 될 때 장치명과, 권한 등을 정해준다. 이 때 그 규칙이 기재된 파일을 참조하게 되는데, 우분투의 경우 '/etc/udev/rules.d/70-persistent-net.rules'파일이 바로 그 파일이다. 


​

센서구동: rplidar laserscan 노드 launch


 $ roslaunch rplidar_ros rplidar.launch
 









센서값 모니터링 1: rplidar laser scan 데이터 콘솔 모니터링 


 $ rosrun rplidar_ros rplidarNodeClient
 









센서값 모니터링 2: rpilidar laser scnan 데이터 visual 모니터링



 $ rviz
 









센서구동 + 센서값모니터링 2


 $ roslaunch rplidar_ros view_rplidar.launch
 











[출처] ROS indigo, RPLIDAR 사용하기 (오픈소스 소프트웨어 & 하드웨어: 로봇 기술 공유 카페 (오로카)) |작성자 GroundZero
